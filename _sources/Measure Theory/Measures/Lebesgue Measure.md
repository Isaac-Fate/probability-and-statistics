# Lebesgue Measure
\
In this section, we shall construct the Lebesgue measure on $\R$ mainly with the CarathÃ©odory's Extension Theorem.
\
We start by defining an additive nonnegative set function $\ell$ on the semi-algebra $\SSS$ in {prf:ref}`eg:1`. Recall $\SSS$ consists of the following five kinds of subsets in $\R$:
1. $\emptyset$
2. $(a, b]$
3. $(a, \infty)$
4. $(-\infty, b]$
5. $\R$
\
Define 
1. $\ell(\emptyset) := 0$
2. $\ell(a, b] := b-a$
3. $\ell(a, \infty) := \infty$
4. $\ell(-\infty, b] := \infty$
5. $\ell(\R) := \infty$
As we can see, the function $\ell$ is simply the length of the intervals, and it is clearly *finitely* additive. We wish to extend this measurement of length to a larger collection of subsets of $\R$, which gives rise to the Lebesgue measure. As a custom, we use $\lambda$ to denote the Lebesgue measure. 
\
It is temping to apply {prf:ref}`thm:3` to extend $\ell$. But then, as required in this theorem, we need to show that $\ell$ is $\sigma$-additive on $\SSS$, which is somehow difficult to prove *directly* even though it may seem to hold naturally.
\
Our strategy is to first apply {prf:ref}`thm:1` to extend $\ell$ to a *finitely* additive set function $\lambda_0$ on the algebra $\A(\SSS)$ generated by $\SSS$. And then we prove $\lambda_0$ is $\sigma$-additive on $\SSS$. In other words, we prove that $\ell$ is $\sigma$-additive by proving the restricted function $\restr{\lambda_0}{\SSS} = \ell$, which itself is defined on an algebra, is $\sigma$-additive. The reason why it is easier to prove $\lambda$ is $\sigma$-additive on $\SSS$ is simply that $\A(\SSS)$ is a larger collection of sets than $\SSS$.
\
After that, we are allowed to extend $\ell$ to the Lebesgue measure $\lambda$ on $\sigma(\SSS)$ as soon as we prove that $\lambda_0$ is $\sigma$-finite, which is easy to prove, to guarantee the uniqueness of the extension.
\
Therefore, our major goal is to prove 
```{math}
:label: eq:17
\begin{align}
\lambda_0(S) = \sum_{k=1}^\infty\lambda(S_k)
\end{align}
```
where $S = \biguplus_{k=1}^\infty S_k$.
\
To prove the equation {eq}`eq:17`, we need to show that the left-hand side is less than or equal to the right-hand side as well as that the right-hand side is less than or equal to the left-hand side. We note that one of these two inequalities is easy to show, which is stated in the following lemma.
````{prf:lemma}
:label: lem:2
If
```{math}
\begin{align*}
A = \biguplus_{k=1}^\infty A_k
\end{align*}
```
where $A, A_k \in\A(\SSS)$, then we have the following inequality:
```{math}
:label: eq:8
\begin{align}
\lambda_0(A) \geq\sum_{k=1}^\infty\lambda_0(A_k) 
\end{align}
```
````
````{prf:proof}
By the finite additivity and monotonicity of $\lambda_0$, for each $n \in\Ns$, we have 
```{math}
\begin{align*}
\lambda_0(A)
= \lambda_0\left(\biguplus_{k=1}^\infty A_k\right)\geq\lambda_0\left(\biguplus_{k=1}^n A_k\right)        = \sum_{k=1}^n \lambda_0(A_k)
\end{align*}
```
Hence, {eq}`eq:8` follows by letting $n \to\infty$.
````
\
As we can see, there are several forms of set $S$, which makes the proof of {eq}`eq:17` rather complicated. We shall first consider the finite intervals. 
````{prf:lemma}
:label: lem:3
Let $S = (a, b]$. If 
```{math}
\begin{align*}
S = \biguplus_{k=1}^\infty S_k
\end{align*}
```
where $S_k \in\SSS$, then 
```{math}
:label: eq:7
\begin{align}
\lambda_0(S) = \sum_{k=1}^\infty\lambda_0(S_k) 
\end{align}
```
````
````{prf:proof}
Without loss of generality, we may assume that $S_k \neq\emptyset\;\forall k \in\Ns$. We observe that each $S_k$ must have the form $(a_k, b_k]$ since $S = (a, b]$. Otherwise, $S$ cannot be a finite interval.
\
By {prf:ref}`lem:2`, we have 
```{math}
:label: eq:13
\begin{align}
\lambda_0(S) \geq\sum_{k=1}^\infty\lambda_0(S_k) 
\end{align}
```
\
On the other hand, for an arbitrary $\varepsilon > 0$, we have 
```{math}
\begin{align*}
[a + \varepsilon, b]\subset(a, b]
= S
= \biguplus_{k=1}^\infty S_k
= \biguplus_{k=1}^\infty(a_k, b_k]\subset\bigcup_{k=1}^\infty(a_k, b_k + \varepsilon / 2^k)
\end{align*}
```
Hence,
```{math}
\begin{align*}
[a + \varepsilon, b]\subset\bigcup_{k=1}^\infty(a_k, b_k + \varepsilon / 2^k)
\end{align*}
```
Note that $[a + \varepsilon, b]$ is a compact set in $\R$, and $\left\{(a_k, b_k + \varepsilon / 2^k)\right\}$ forms an open cover. Therefore, there exists $n \in\Ns$ such that 
```{math}
\begin{align*}
[a + \varepsilon, b]\subset\bigcup_{k=1}^n (a_k, b_k + \varepsilon / 2^k)
\end{align*}
```
Then by the monotonicity and finite subadditivity of $\lambda_0$, we have 
```{math}
\begin{align*}
b-a-\varepsilon 
= \lambda_0 (a+\varepsilon, b]&\leq\lambda_0 [a+\varepsilon/2, b]\\&\leq\lambda_0 \left( \bigcup_{k=1}^n (a_k, b_k + \varepsilon / 2^k) \right)\\&\leq\sum_{k=1}^n \lambda_0 (a_k, b_k + \varepsilon / 2^k) \\&\leq\sum_{k=1}^n \lambda_0 (a_k, b_k + \varepsilon / 2^k]\\&= \sum_{k=1}^n (b_k - a_k) + 
\sum_{k=1}^n \varepsilon/2^k \\&< \varepsilon + \sum_{k=1}^\infty(b_k - a_k)
\end{align*}
```
In summary, we have obtained
```{math}
\begin{align*}
\lambda_0 (a, b] = b - a 
< 2\varepsilon + \sum_{k=1}^\infty(b_k - a_k)
= 2\varepsilon + \sum_{k=1}^\infty\lambda_0 (a_k, b_k]\quad\forall\varepsilon > 0
\end{align*}
```
Therefore, we have 
```{math}
:label: eq:9
\begin{align}
\lambda_0 (S) \leq\sum_{k=1}^\infty\lambda_0 (S_k)
\end{align}
```
by letting $\varepsilon\to 0$.
\
Finally, {eq}`eq:13` follows from {eq}`eq:8` and {eq}`eq:9`.
````
\
Before extending the {prf:ref}`lem:3` to general $S$, we need the following limit formula.
````{prf:lemma}
:label: lem:4
Let $E_n = (-n, n]$ where $n \in\Ns$. Then 
```{math}
:label: eq:10
\begin{align}
\lim_{n \to \infty}\lambda_0 (S \cap E_n) = \lambda_0(S)
\end{align}
```
where $S \in\SSS$.
````
````{prf:proof}
First, we observe that indeed $S \cap E_n \in\SSS\subset\A(\SSS) \;\forall n \in\Ns$. We then prove {eq}`eq:10` by considering each form of $S$.
\
($S = \emptyset$) {eq}`eq:10` holds because
```{math}
\begin{align*}
\lambda_0(S \cap E_n) = \lambda_0(\emptyset) = 0
\end{align*}
```
\
($S = (a, b]$) There exists a large enough $N \in\Ns$ such that $N > \max\left\{-a, b\right\}$. It follows that 
```{math}
\begin{align*}
S \cap E_n = (a, b]\cap(-n, n]
= (a, b]
= S
\quad\forall n \geq N
\end{align*}
```
Thus, 
```{math}
\begin{align*}
\lambda_0(S \cap E_n)
= \lambda_0(S)
\quad\forall n \geq N
\end{align*}
```
which implies {eq}`eq:10`.
\
($S = (a, \infty)$) There exists $N \in\Ns$ such that $N > -a$. Then, we have 
```{math}
\begin{align*}
S \cap E_n
= (a, \infty) \cap(-n, n]
= (a, n]\quad\forall n \geq N
\end{align*}
```
It then follows that 
```{math}
\begin{align*}
\lambda_0(S \cap E_n)
= \lambda_0 (a, n]
= n-a
\quad\forall n \geq N
\end{align*}
```
By letting $n \to\infty$, we obtain
```{math}
\begin{align*}
\lim_{n\to\infty}\lambda_0(S \cap E_n)
= \lim_{n\to\infty}(n-a) = \infty
= \lambda_0 (a, \infty)
= \lambda_0(S)
\end{align*}
```
which is exactly {eq}`eq:10`.
\
($S = (-\infty, b]$) Similar to the proof of the preceding case, we have 
```{math}
\begin{align*}
S \cap E_n = (-n, b]\quad\forall n \geq N
\end{align*}
```
where $N$ is a constant integer larger than $b$. It follows that 
```{math}
\begin{align*}
\lim_{n\to\infty}\lambda_0(S \cap E_n)
= \lim_{n\to\infty}(n+b)
= \infty
= \lambda_0 (-\infty, b]
= \lambda_0(S)
\end{align*}
```
($S = \R$) In this case, we have 
```{math}
\begin{align*}
S \cap E_n = \R\cap(-n, n]
= (-n, n]\quad\forall n \in\Ns\end{align*}
```
It follows that 
```{math}
\begin{align*}
\lim_{n\to\infty}\lambda_0(S \cap E_n)
= \lim_{n\to\infty} 2n
= \infty
= \lambda_0(\R)
= \lambda_0(S)
\end{align*}
```
````
\
We are now ready to prove {eq}`eq:17` for all possible forms of $S$.
````{prf:lemma}
Let $S \in\SSS$. If 
```{math}
\begin{align*}
S = \biguplus_{k=1}^\infty S_k
\end{align*}
```
where $S_k \in\SSS$, then 
```{math}
:label: eq:12
\begin{align}
\lambda_0(S) = \sum_{k=1}^\infty\lambda_0(S_k) 
\end{align}
```
````
````{prf:proof}
Firstly, by {prf:ref}`lem:2`, we have 
```{math}
:label: eq:14
\begin{align}
\lambda_0(S) \geq\sum_{k=1}^\infty\lambda_0(S_k) 
\end{align}
```
What is left to prove is 
```{math}
:label: eq:15
\begin{align}
\lambda_0(S) \leq\sum_{k=1}^\infty\lambda_0(S_k) 
\end{align}
```
If $S = \emptyset$, then {eq}`eq:15` holds trivially, since all $S_k$'s must also be empty sets. In the rest of the proof, we assume that $S \neq\emptyset$. Let $E_n = (-n, n]$. It is clear that $S \cap E_n \in\SSS$ since $S, E_n \in\SSS$. Moreover, we observe that the set $S \cap E_n$ has the form $(a, b]$ for $n \geq N$ where $N \in\Ns$ is some constant large enough integer. It then follows from {prf:ref}`lem:3` that 
```{math}
:label: eq:16
\begin{align}
\lambda_0(S \cap E_n)
= \sum_{k=1}^\infty\lambda_0 (S_k \cap E_n)
\leq\sum_{k=1}^\infty\lambda_0 S_k
\end{align}
```
The last inequality follows from the monotonicity of $\lambda_0$. We then send $n \to\infty$ on both sides of {eq}`eq:16`. It follows from {prf:ref}`lem:4` that 
```{math}
\begin{align*}
\lambda_0(S)
= \lim_{n\to\infty}\lambda_0(S \cap E_n)
\leq\sum_{k=1}^\infty\lambda_0(S_k)
\end{align*}
```
which is exactly {eq}`eq:15`. This completes the proof.
````

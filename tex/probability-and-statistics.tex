\documentclass[thmcnt=section, 12pt]{elegantbook}

% Index page
\usepackage{imakeidx}
\makeindex[columns = 2, intoc, options= -s index_style.ist]

% Title and author
\title{Probability and Statistics}
\author{Isaac FEI}

\cover{cover}



\begin{document}

% Print title and cover page
\maketitle

% Print table of contents
\frontmatter
\tableofcontents
\mainmatter

%------------------------------
% Main document starts from here
%------------------------------

%==============================
%==============================

\part{Measure Theory}

%==============================
%==============================



%==============================

\chapter{Measures}

%==============================

\section{Semi-Algebras, Algebras and Sigma-Algebras}

%------------------------------

\begin{definition}[Semi-Algebras]
    A family of subsets $\SSS$ of $\Omega$ is a semi-algebra if it
    \begin{enumerate}
        \item contains the empty set, i.e., $\emptyset \in \SSS $, 
        \item closed under finite Intersections, i.e., $A, B \in \SSS \implies A \cap B \in \SSS$, and 
        \item the complement of each set in $\SSS$ can be written as a finite disjoint union of other sets in $\SSS$, i.e., $A \in \SSS \implies \exists E_1, \ldots, E_n \in  \SSS, \; A = \biguplus_{i=1}^n E_i$.
    \end{enumerate}
\end{definition}

\begin{example} \label{eg:1}
    Consider the following semi-algebra on $\R$:
    \begin{align*}
        \SSS = \emptyset 
        \cup \set{(a, b]}{a, b \in \R, a < b}
        \cup \set{(a, \infty)}{a \in \R}
        \cup \set{(-\infty, b]}{b \in \R}
        \cup \R
    \end{align*}
    It is easy to verify that it is indeed a semi-algebra. In fact, the definition of semi-algebra arises from the study of this very example. We will construct the famous Lebesgue measure from this semi-algebra, which defines the length of a set.
\end{example}

%------------------------------

\begin{definition}[$\sigma$-Algebras]
    A family of subsets $\F$ of $\Omega$ is a $\sigma$-algebra \index{$\sigma$-algebra} if it satisfies the following:
    \begin{enumerate}
        \item $\emptyset \in \F$
        \item $\F$ is closed under complements, i.e., $A \in \F \implies A^\complement \in \F$
        \item $\F$ is closed under countable unions, i.e., $A_i \in \F \; \forall i \in \Ns \implies \bigcup_{i=1}^\infty A_i \in \F $
    \end{enumerate}
\end{definition}

%------------------------------

\begin{definition}
    The Borel $\sigma$-algebra $\B(\R^d)$ on $\R^d$ is defined as the $\sigma$-algebra generated by the collection of all open sets in $\R^d$. Mathematically, 
    \begin{align*}
        \B(\R^d) := \sigma(\tau)
    \end{align*}
    where $\tau$ is the Euclidean topology on $\R^d$.
\end{definition}

%------------------------------

\begin{lemma}
    Suppose $\CC_1, \CC_2 \subset \Omega$. If for any $E \in \CC_1$, either one of the following holds:
    \begin{enumerate}
        \item $E = F^\complement$ for some $F \in \CC_2$
        \item $E = \bigcup_{i=1}^\infty F_i$ where $F_i \in \CC_2 \; \forall i \in \Ns$
        \item $E = \bigcap_{i=1}^\infty F_i$ where $F_i \in \CC_2 \; \forall i \in \Ns$
    \end{enumerate}
    then we have 
    \begin{align*}
        \sigma(\CC_1) \subset \sigma(\CC_2)
    \end{align*}
\end{lemma}

%------------------------------

\section{Measures}

%------------------------------

\par A \textbf{set function} \index{set function} is a function that maps from collections of subsets of $\Omega$ to the extended real numbers $\R \cup \left\{\pm \infty\right\}$.

\par We say a set function $\mu$ is \textbf{finitely additive} \index{finitely additive} if 
\begin{align*}
    \mu(A \uplus B) = \mu(A) + \mu(B)
\end{align*}
The above equation also holds for finitely many disjoint unions of sets, that is, 
\begin{align}
    \mu\left(\biguplus_{i=1}^n A_i\right) = \sum_{i=1}^n \mu(A_i)
    \label{eq:1}
\end{align}
which can be proved by the mathematical induction.

\par If \eqref{eq:1} holds for countably infinite disjoint unions of sets, i.e., 
\begin{align*}
    \mu\left(\biguplus_{i=1}^n A_i\right) = \sum_{i=1}^\infty \mu(A_i)
\end{align*}
Then we say $\mu$ is \textbf{$\sigma$-additive} \index{$\sigma$-additive}. 

%------------------------------

\begin{definition}
    Let $(\Omega, \F)$ be a measurable space. A set function $\mu: \F \to [0, \infty]$ is called a \textbf{measure} \index{measure} if
    \begin{enumerate}
        \item $\mu(\emptyset) = 0$, and 
        \item $\mu$ is $\sigma$-additive.
    \end{enumerate}
    The triplet $(\Omega, \F, \mu)$ is then called a \textbf{measure space} \index{measure space}.
\end{definition}

\par If $\mu$ is only finitely additive, we say that $\mu$ is a \textbf{finitely additive measure} \index{finitely additive measure}. 

\begin{remark}
    If we assume $\mu: \F \to [0, \infty]$ is $\sigma$-additive, and there exists some set $A \in \F$ such that $\mu(A) < \infty$, then $\mu(\emptyset) = 0$ holds naturally and hence condition 1 is redundant. To see this, we note that $\mu(A) = \mu(A \uplus \emptyset) = \mu(A) + \mu(\emptyset)$, which implies $\mu(\emptyset) = 0$ provided that $\mu(A)$ is finite.
\end{remark}

%------------------------------

\par The following proposition shows the monotonicity of a measure.

\begin{proposition} \label{pro:2}
    Let $(\Omega, \F, \mu)$ be a measure space. For $A, B \in \F$, we have
    \begin{align}
        A \subset B \implies \mu(A) \leq \mu(B)
        \label{eq:2}
    \end{align}
    Moreover, if $\mu(A) < \infty$ in \eqref{eq:2}, we have 
    \begin{align*}
        \mu(B \setminus A) = \mu(B) - \mu(A)
    \end{align*}
\end{proposition}

\begin{proof}
    Suppose $A \subset B$. We have 
    \begin{align*}
        B = A \uplus (B \setminus A)
    \end{align*}
    By the $\sigma$-additivity (or weaker, the finite additivity), it follows that 
    \begin{align*}
        \mu(B) = \mu(A) + \mu(B \setminus A)
    \end{align*}
    \eqref{eq:2} follows since $\mu(B \setminus A) \geq 0$. If $\mu(A) < \infty$, by subtracting $\mu(A)$ from both sides of the above equation, we obtain
    \begin{align*}
        \mu(B) - \mu(A) = \mu(B \setminus A)
    \end{align*}
\end{proof}

%------------------------------

\par Given a sequence of sets $\left\{A_k\right\}$, we need this sequence of sets to be mutually disjoint in order to apply the $\sigma$-additivity of a measure. However, it is not the case in general. But we can easily construct another sequence of mutually disjoint sets from $\left\{A_k\right\}$ while keeping the union of first $n$ sets unchanged. The procedure is illustrated in the following proposition.

\begin{proposition}[Construction of Mutually Disjoint Sets] \label{pro:1}
    Let $\left\{A_k\right\}_{k\in\Ns}$ be sequence of subsets of $\Omega$. Let $B_k$ be given by 
    \begin{align*}
        B_k = A_k \setminus \bigcup_{i=1}^{k-1} A_i
    \end{align*}
    where $A_0 := \emptyset$. Then $\left\{ B_k \right\}$ is a family of mutually disjoint sets, and 
    \begin{align*}
        \biguplus_{k=1}^n B_k 
        = \bigcup_{k=1}^n A_k
        \quad \forall n \in \Ns
    \end{align*}
    Specially, 
    \begin{align*}
        \biguplus_{k=1}^\infty B_k 
        = \bigcup_{k=1}^\infty A_k
    \end{align*}
\end{proposition}

\begin{remark}
    This technique will be frequently used in the proofs of upcoming propositions and theorem.
\end{remark}

\begin{proof}
    % TODO
\end{proof}

%------------------------------

\begin{proposition}
    Let $(\Omega, \F, \mu)$ be a measure space, and $\left\{A_k\right\}$ a sequence of sets in $\F$. We have 
    \begin{align}
        \mu\left(\bigcup_{k=1}^\infty A_k\right)
        \leq \sum_{k=1}^\infty \mu(A_k)
        \label{eq:3}
    \end{align}
\end{proposition}

\begin{remark}
    If a set function satisfies \eqref{eq:3}, we say that it is \textbf{$\sigma$-subadditive} \index{$\sigma$-subadditive}.
\end{remark}

\begin{proof}
    Let $B_k$ be given by 
    \begin{align*}
        B_k = A_k \setminus \bigcup_{i=1}^{k-1} A_i
    \end{align*}
    as in Proposition~\ref{pro:1}. Then we have 
    \begin{align*}
        \mu\left(\bigcup_{k=1}^\infty A_k\right)
        = \mu\left(\biguplus_{k=1}^\infty B_k\right)
        = \sum_{k=1}^\infty \mu(B_k)
        \leq \sum_{k=1}^\infty \mu(A_k)
    \end{align*}
    The last inequality follows from Proposition~\ref{pro:2}.
\end{proof}

%------------------------------

\begin{proposition} \label{pro:3}
    % TODO
\end{proposition}

%------------------------------

\section{Extension of Set Functions on Semi-Algebras}

%------------------------------

\begin{theorem} \label{thm:1}
    Let $\SSS$ be a semi-algebra on $\Omega$, and $\mu: \SSS \to [0, \infty]$ a nonnegative additive (resp. $\sigma$-additive) set function. Then $\mu$ can be extended uniquely to an additive (resp. $\sigma$-additive) function $\nu$ on $\A(\SSS)$. That is, $\exists! \nu: \A(\SSS) \to [0, \infty]$ such that
    \begin{enumerate}
        \item $\nu$ is additive (resp. $\sigma$-additive), and 
        \item $\restr{\nu}{\SSS} = \mu$.
    \end{enumerate}
    To be specific, this extension $\nu$ is given by 
    \begin{align*}
        \nu(A) = \sum_{i=1}^n \mu(E_i)
    \end{align*}
    where $\left\{E_1, \ldots, E_n\right\}$ is a family of mutually disjoint sets in $\SSS$ satisfying $A = \biguplus_{i=1}^n E_i$.
\end{theorem}

%------------------------------

\section{Carathéodory's Extension Theorem}

%------------------------------

\begin{definition} \label{def:1} % Definition of the outer measure
    An \textbf{outer measure}\index{outer measure} on $ \Omega $ is a set function $ \mu^\ast : \Pow(\Omega) \to [0, \infty] $ such that it
    \begin{enumerate}
        \item assumes zero at empty set, i.e., $ \mu^\ast(\emptyset) = 0 $, and
        \item is $ \sigma $-subadditive, i.e., $ E \subset \bigcup_{i=1}^\infty {E_i}, \; \mu^\ast(E) \leq \sum_{i=1}^\infty {\mu^\ast(E_i)} $
    \end{enumerate}
\end{definition}

%------------------------------

\begin{definition}
    Suppose that $ \mu^\ast $ is an outer measure on $ \Omega $. The collection of \textbf{measurable sets}\index{measurable sets} with respect to $ \mu^\ast $ is defined by 
    \begin{align*}
        \M = \set{A \subset \Omega}{\forall E \subset \Omega, \; \mu^\ast(E) = \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)}
    \end{align*}
    Sometimes, we also say the sets in $ \M $ are $ \mu^\ast $-measurable.
\end{definition}

%------------------------------

\begin{theorem} \label{thm:4} % The collection of mu-measurable sets is a sigma-algebra and the outer measure mu restricted on this collection is sigma-additive.
    Let $ \mu^\ast $ be an outer measure on $ \Omega $ and $ \M $ the collection of $ \mu^\ast $-measurable sets. We claim that 
    \begin{enumerate}
        \item $ \M $ is a $ \sigma $-algebra, and
        \item $ \restr{\mu^\ast}{\M} $ is $ \sigma $-additive.
    \end{enumerate}
\end{theorem}

\par Consider the equality 
\begin{align*}
    \mu^\ast(E) = \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)
\end{align*}
in the definition of $ \M $. Note that it always holds that 
\begin{align*}
    \mu^\ast(E) \leq \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)
\end{align*}
because $ E \subset (E\cap A) \cup (E \cap A^\complement) $ and $ \mu^\ast $ is an outer measure and hence $ \sigma $-subadditive. Therefore, in the following proofs, we only need to show  
\begin{align*}
    \mu^\ast(E) \geq \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)
\end{align*}
in order to prove the equality.

\par Before proving that $ \M $ is a $ \sigma $-algebra, we first show that it is an algebra.
\begin{proof}
    We shall check each condition in the definition of an algebra.

    \par (Containment of the Empty Set) Note that 
    \begin{align*}
        \mu^\ast(E \cap \Omega) + \mu^\ast(E \cap \Omega^\complement) = \mu^\ast(E) + 0 = \mu^\ast(E)
    \end{align*}
    Therefore, clearly $ \Omega \in \M $.

    \par (Closure under Complements) Suppose $ A \in \M $, then $ \forall E \subset \Omega $, we have
    \begin{align*}
        \mu^\ast(E) = \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement) = \mu^\ast(E \cap (A^\complement)^\complement) + \mu^\ast(E \cap A^\complement)
    \end{align*}
    The last equality above implies that $ A^\complement \in \M $.
    
    \par (Closure under Finite Intersections) Suppose $ A_1, A_2 \in \M $. Let $ E \subset \Omega $ be arbitrary, then 
    \begin{alignat}{3}
        \mu^\ast(E)
        &=& \; & \mu^\ast(E \cap A_1) + \mu^\ast(E \cap {A_1}^\complement) &\quad&\text{since $ A_1 \in \M $} \nonumber\\
        &=& \; & \mu^\ast(E \cap A_1 \cap A_2) + \mu^\ast(E \cap A_1 \cap {A_2}^\complement) + \mu^\ast(E \cap {A_1}^\complement) &\quad&\text{since $ A_2 \in \M $} \label{eq:18}
    \end{alignat}
    On the other hand, consider $ \mu^\ast(E \cap {(A_1 \cap A_2)}^\complement) $. We have 
    \begin{alignat}{3}
        \mu^\ast(E \cap {(A_1 \cap A_2)}^\complement)
        &=& \; & \mu^\ast((E \cap {A_1}^\complement) \cup (E \cap {A_2}^\complement)) &\quad& \nonumber\\
        &=& \; & \mu^\ast(E \cap A_1 \cap {A_2}^\complement) + \mu^\ast(E \cap {A_1}^\complement) &\quad&\text{since $ A_1 \in \M $} \label{eq:19}
    \end{alignat}
    Combining equations \eqref{eq:18} and \eqref{eq:19}, we obtain
    \begin{align*}
        \mu^\ast(E) = \mu^\ast(E \cap A_1 \cap A_2) + \mu^\ast(E \cap {(A_1 \cap A_2)}^\complement)
    \end{align*}
    Therefore, $ A_1 \cap A_2 \in \M $.

\end{proof}

\par In the following, we show that $ \restr{\mu^\ast}{\M} $ is $ \sigma $-additive.
\begin{proof}
    We prove this by first showing $ \mu^\ast $ is additive on $ \M $ and then applying Proposition~\ref{pro:3} to conclude that $ \mu^\ast $ is actually $ \sigma $-additive on $ \M $.

    \par (Additivity) First, clearly $ \mu^\ast(\emptyset) = 0 $ since $ \mu^\ast $ is an outer measure. Suppose $ A_1, A_2 \in \M $ and $ A = A_1 \uplus A_2 $. Note that $ A \in \M $ since we have shown that $ \M $ is an algebra. It follows that 
    \begin{align*}
        \mu^\ast(A) = \mu^\ast(A \cap A_1) + \mu^\ast(A \cap {A_1}^\complement)
    \end{align*}
    Note that $ A \cap A_1 = A_1 $ and $ A \cap {A_1}^\complement = A_2 $. Therefore,
    \begin{align*}
        \mu^\ast(A) = \mu^\ast(A_1) + \mu^\ast(A_2)
    \end{align*}
    Then by induction, we can show that for $ A_i \in \M $,
    \begin{align*}
        \mu^\ast\left(\biguplus_{i=1}^n {A_i}\right) = \sum_{i=1}^n {\mu^\ast(A_i)}
    \end{align*}

    \par ($ \sigma $-Additivity) Note that $ \mu^\ast $ is $ \sigma $-subadditive on $ \Pow(\Omega) $ (and of course it is also $ \sigma $-subadditive on $ \M $) because $ \mu^\ast $ is an outer measure. Moreover, we have already shown that $ \mu^\ast $ is also additive on $ \M $. Then Proposition~\ref{pro:3} immediately implies that $ \mu^\ast $ is $ \sigma $-additive.
\end{proof}

\par Finally, we show that $ \M $ is actually a $ \sigma $-algebra. 
\begin{proof}
    Recall that we have already shown $ \M $ is an algebra. Hence, we only need to show that $ \M $ is closed under countable unions. Suppose that $ A_i \in \M $ and $ A = \bigcup_{i=1}^\infty {A_i} $. Fix a set $ E \subset \Omega $. Note that $ \bigcap_{i=1}^n {A_i} \in \M $ since $ \M $ is an algebra. It then follows that 
    \begin{alignat*}{2}
        \mu^\ast(E)
        &=& \; & \mu^\ast\left( E \cap \bigcap_{i=1}^n {A_i} \right) + \mu^\ast\left( E \cap \left(\bigcap_{i=1}^n {A_i}\right)^\complement \right) \\
        &=&& \mu^\ast\left( E \cap \bigcap_{i=1}^n {A_i} \right) + \mu^\ast \left( E \cap \bigcup_{i=1}^n {{A_i}^\complement} \right)
    \end{alignat*}
    And since $ E \cap \bigcap_{i=1}^n {A_i} \supset E \cap \bigcap_{i=1}^\infty {A_i} = E \cap A $, we have 
    \begin{align}
        \mu^\ast(E) \geq \mu^\ast(E \cap A) + \mu^\ast\left( E \cap \bigcup_{i=1}^n {{A_i}^\complement} \right) \label{eq:20}
    \end{align}
    For the convenience of the notations, we denote
    \begin{align*}
        F_i = E \cap \bigcup_{j=1}^i {{A_j}^\complement}
    \end{align*}
    Define sets $ G_i $ as follows.
    \begin{align*}
        G_1 &= F_1 & G_i &= F_i \setminus \bigcup_{j=1}^{i-1} {F_j} \quad  i \geq 2
    \end{align*}
    One can show that all $ G_i $'s are mutually disjoint and $ \bigcup_{i=1}^n {G_i} = \bigcup_{i=1}^n {F_i} $. It is also true that $ \bigcup_{i=1}^\infty {G_i} = \bigcup_{i=1}^\infty {F_i} $. In summary,
    \begin{align*}
        \biguplus_{i=1}^n {G_i} &= \bigcup_{i=1}^n {F_i} & \biguplus_{i=1}^\infty {G_i} &= \bigcup_{i=1}^\infty {F_i} = E \cap A^\complement
    \end{align*}
    Applying the additivity of $ \mu^\ast $ (this is valid because $ G_i \in \M $) to inequality \eqref{eq:20}, we obtain
    \begin{align*}
        \mu^\ast(E) \geq \mu^\ast(E \cap A) + \mu^\ast\left(\biguplus_{i=1}^n G_i\right) = \mu^\ast(E \cap A) + \sum_{i=1}^n {\mu^\ast(G_i)}
    \end{align*}
    Letting $ n \to \infty $, 
    \begin{align*}
        \mu^\ast(E) \geq \mu^\ast(E \cap A) + \sum_{i=1}^\infty {\mu^\ast(G_i)}
    \end{align*}
    Then we apply the $ \sigma $-subadditivity of $ \mu^\ast $,
    \begin{align*}
        \mu^\ast(E) \geq \mu^\ast(E \cap A) + \sum_{i=1}^\infty {\mu^\ast(G_i)} \geq \mu^\ast(E \cap A) + \mu^\ast\left(\biguplus_{i=1}^\infty {G_i}\right) = \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)
    \end{align*}
    Therefore, we have shown that 
    \begin{align*}
        \mu^\ast(E) \geq \mu^\ast(E \cap A) + \mu^\ast(E \cap A^\complement)
    \end{align*}
    In fact, the inequality above can be replaced by equality as we have explained before. Therefore, $ A \in \M $ and hence $ \M $ is indeed a $ \sigma $-algebra.
\end{proof}

%------------------------------

\par The following theorem extends a pre-measure, i.e., a $\sigma$-additive nonnegative set function on an algebra $\A$ to a measure on the $\sigma$-algebra generated by $\A$.

\begin{theorem}[Carathéodory's Extension Theorem] \label{thm:2}
    Let $\A$ be an algebra on $\Omega$, and $\mu_0$ a pre-measure on $\A$. Then $\mu_0$ can be extended to a measure $\mu$ on $\F = \sigma(\A)$, i.e., there exists a measure $\mu: \F \to [0, \infty]$ such that $\restr{\mu}{\A} = \mu_0$. Furthermore, if $\mu_0$ is $\sigma$-fintie, then the extension is unique.
\end{theorem}

\begin{proof}
    % TODO
\end{proof}

%------------------------------

\begin{theorem}[Extension of Set Funcitons on Semi-Algebras] \label{thm:3}
    Let $\SSS$ be a semi-algebra on $\Omega$, and $\nu: \SSS \to [0, \infty]$ a $\sigma$-additive set function. Then, $\nu$ can be first uniquely extended to a pre-measure $\mu_0$ on $\A(\SSS)$. After that, if $\mu_0$ is $\sigma$-fintie, it can be extended uniquely to a measure $\mu$ on $\sigma(\SSS)$. (Note that $\sigma(\A(\SSS)) = \sigma(\SSS)$).
\end{theorem}

%------------------------------

\section{Lebesgue Measure}

%------------------------------



%------------------------------



%==============================
%==============================

\part{Probability Theory}

%==============================
%==============================



%==============================

\chapter{Random Variables, Expectations, and Independence}

%==============================

\section{Random Variables}

\par We define random variables formally.

%------------------------------






%==============================
%==============================

\part{Mathematical Statistics}

%==============================
%==============================



%==============================

\chapter{Fundamentals of Statistics}

%==============================

\section{Populations, Samples and Models}

\par We shall introduce basic concepts.

%------------------------------

\section{Statistical Decision Theory}

\par We shall discuss decision theory.

%------------------------------

% Print index page
\printindex

%==============================

\end{document}